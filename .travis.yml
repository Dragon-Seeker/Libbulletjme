---
# configure deployment and continuous integration at travis-ci.com

arch: amd64
dist: xenial
language: cpp
os: linux

jobs:
  include:
    - os: osx
      osx_image: xcode13.2
      script:
        - brew install gcc@9
        - which gcc
        - echo $PATH
        - ls -l /Users/travis/.rvm/gems/ruby-2.6.6/bin/*gcc*
        - ls -l /Users/travis/.rvm/gems/ruby-2.6.6@global/bin/*gcc*
        - ls -l /Users/travis/.rvm/rubies/ruby-2.6.6/bin/*gcc*
        - ls -l /Users/travis/.rvm/bin/*gcc*
        - ls -l /Users/travis/bin/*gcc*
        - ls -l /Users/travis/.local/bin/*gcc*
        - ls -l /Users/travis/.nvm/versions/node/v17.2.0/bin/*gcc*
        - ls -l /usr/local/bin/*gcc*
        - ls -l /usr/bin/*gcc*
        - ls -l /bin/*gcc*
        - ls -l /usr/sbin/*gcc*
        - ls -l /sbin/*gcc*
        - ls -l /opt/X11/bin/*gcc*
        - ls -l /Library/Apple/usr/bin/*gcc*
        - which g++
        - ls -l /usr/bin/*g++*
#        - ./gradlew build --console=plain --no-daemon -Ptravis=osx64


addons:
  apt:
    update: true
  homebrew:
    packages:
      gcc@8
after_failure:
  - cat build/reports/tests/test/classes/TestLibbulletjme.html
before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/
    - $HOME/.android/build-cache

deploy:
  provider: releases
  skip_cleanup: true
  api_key:
    secure: "fzb+2XOd2MPVqlraro/IDKMWONIuvkpJZR75zr20sXCA15wVI4Q63JMX6rT6m708As8rM//7PCvzlcdIhQZv0Dj995cbCKTHMf+Ef4M6T379f5yrnnGXH/x6Z3mSPEOmL2P2vCx1I0fMe8V7Ap7QOEzL1NYcZQPaR4tjkfTEevJ7HXOiUyBK3aR1XiP19zmPIm/whYuexmmHjT2jDN6j8QhU+wB2F88aTfLeFXo5QZtghJYEhTEDKsFf6PmSvB6OUcG83Ko5Ke1Mkpe8r/bED6egbr8MEM7NRlPNtmQtgfjoymtgQSPckr/xPef3CwB04mAYGJjxEjOogXZulWUIkiTh9GD7h1MLOlDsR8tqEVDcq8/rgaPXB+y5oqThVzC6c75gMJSn8RxOQMR3YiC99Qg3+YYieQAf0YwyCw9mCqQir7vNPlvnqjLbaGT41cdJtmUnEQ5XivjUUpTMTApjeiv/feTbrWj3m75e8EOuki6LIgvweLXXGSt16fjAIcoNEB1DoopYhNDx1D8S+z7xu/wKcCV8uHgu1voJl2oJG2qPTtS9Czfr4/Za3nNJ8RO5vTwjpKgBjxbGwnNK5JIAsHCzK01jYY9JpKcD4WUpqKBxrLzctYq/nNAdyYfo6lrq6xNZnPvuEO3Y3JSySvfR+dyVXVBTrQmFDE7HDX/VqvU="
  file:
    - dist/Android_ARM7DebugSp_libbulletjme.so
    - dist/Android_ARM7ReleaseSp_libbulletjme.so
    - dist/Android_ARM8DebugSp_libbulletjme.so
    - dist/Android_ARM8ReleaseSp_libbulletjme.so
    - dist/Android_X86DebugSp_libbulletjme.so
    - dist/Android_X86ReleaseSp_libbulletjme.so
    - dist/Android_X86_64DebugSp_libbulletjme.so
    - dist/Android_X86_64ReleaseSp_libbulletjme.so
    - dist/Linux32DebugDp_libbulletjme.so
    - dist/Linux32DebugSp_libbulletjme.so
    - dist/Linux32ReleaseDp_libbulletjme.so
    - dist/Linux32ReleaseSp_libbulletjme.so
    - dist/Linux64DebugDp_libbulletjme.so
    - dist/Linux64DebugDpMt_libbulletjme.so
    - dist/Linux64DebugSp_libbulletjme.so
    - dist/Linux64DebugSpMt_libbulletjme.so
    - dist/Linux64ReleaseDp_libbulletjme.so
    - dist/Linux64ReleaseDpMt_libbulletjme.so
    - dist/Linux64ReleaseSp_libbulletjme.so
    - dist/Linux64ReleaseSpMt_libbulletjme.so
    - dist/Linux_ARM32DebugDp_libbulletjme.so
    - dist/Linux_ARM32DebugSp_libbulletjme.so
    - dist/Linux_ARM32ReleaseDp_libbulletjme.so
    - dist/Linux_ARM32ReleaseSp_libbulletjme.so
    - dist/Linux_ARM32hfDebugDp_libbulletjme.so
    - dist/Linux_ARM32hfDebugSp_libbulletjme.so
    - dist/Linux_ARM32hfReleaseDp_libbulletjme.so
    - dist/Linux_ARM32hfReleaseSp_libbulletjme.so
    - dist/Linux_ARM64DebugDp_libbulletjme.so
    - dist/Linux_ARM64DebugSp_libbulletjme.so
    - dist/Linux_ARM64ReleaseDp_libbulletjme.so
    - dist/Linux_ARM64ReleaseSp_libbulletjme.so
    - dist/MacOSX32DebugDp_libbulletjme.dylib
    - dist/MacOSX32DebugSp_libbulletjme.dylib
    - dist/MacOSX32ReleaseDp_libbulletjme.dylib
    - dist/MacOSX32ReleaseSp_libbulletjme.dylib
    - dist/MacOSX64DebugDp_libbulletjme.dylib
    - dist/MacOSX64DebugSp_libbulletjme.dylib
    - dist/MacOSX64ReleaseDp_libbulletjme.dylib
    - dist/MacOSX64ReleaseSp_libbulletjme.dylib
    - dist/MacOSX_ARM64DebugDp_libbulletjme.dylib
    - dist/MacOSX_ARM64DebugSp_libbulletjme.dylib
    - dist/MacOSX_ARM64ReleaseDp_libbulletjme.dylib
    - dist/MacOSX_ARM64ReleaseSp_libbulletjme.dylib
  on:
    repo: stephengold/Libbulletjme
    tags: true   # deploy on tag push only
